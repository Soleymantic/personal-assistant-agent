<div class="page">
  <header class="app-header">
    <div class="brand-row">
      <div class="brand" role="img" aria-label="Bürokratie-Assistent">
        <span class="brand-icon material-symbols-rounded" aria-hidden="true">inbox</span>
        <span class="sr-only">Bürokratie-Assistent</span>
      </div>
      <div class="session" *ngIf="user$ | async as user">
        <div class="user-chip" aria-label="Angemeldeter Benutzer">
          <span class="user-icon material-symbols-rounded" aria-hidden="true">account_circle</span>
          <span class="user-name">{{ user.firstName }} {{ user.lastName }}</span>
        </div>
        <button type="button" class="logout-button" (click)="logout()">Abmelden</button>
      </div>
    </div>
    <app-filter-bar
      [searchTerm]="inbox.searchTerm()"
      [selectedTags]="inbox.selectedTags()"
      [availableTags]="inbox.availableTags"
      (searchChange)="inbox.setSearch($event)"
      (toggleTag)="inbox.toggleTag($event)"
    />
    <app-status-filter
      [activeStatus]="inbox.activeStatus()"
      (setStatus)="inbox.setStatus($event)"
    />
  </header>

  <main class="layout">
    <app-inbox-column
      title="Pending"
      [items]="inbox.pendingItems()"
      accent="warning"
      [selectedId]="inbox.selectedItem()?.id ?? null"
      (selectItem)="inbox.selectItem($event)"
    />

    <app-inbox-column
      title="Needs Action"
      [items]="inbox.needsActionItems()"
      accent="danger"
      [selectedId]="inbox.selectedItem()?.id ?? null"
      (selectItem)="inbox.selectItem($event)"
    />

    <app-inbox-column
      title="Paid"
      [items]="inbox.paidItems()"
      accent="success"
      [selectedId]="inbox.selectedItem()?.id ?? null"
      (selectItem)="inbox.selectItem($event)"
    />

    <app-detail-panel
      [document]="inbox.selectedItem()"
      (pay)="applyAction('pay')"
      (reply)="applyAction('reply')"
    />
  </main>
</div>
